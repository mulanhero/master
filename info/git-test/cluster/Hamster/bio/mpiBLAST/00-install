----------------------------------------------------------------
1. download, untar, patch
----------------------------------------------------------------
[root@gphd-vm33 bio]# pwd
/nfs_share/bio
[root@gphd-vm33 bio]# wget http://www.mpiblast.org/downloads/files/mpiBLAST-1.6.0.tgz
[root@gphd-vm33 bio]# wget http://www.mpiblast.org/downloads/files/mpiBLAST-1.6.0-patch-110806
[root@gphd-vm33 bio]# tar -zxvf mpiBLAST-1.6.0.tgz
[root@gphd-vm33 mpiblast-1.6.0]# patch -p1 < ../mpiBLAST-1.6.0-patch-110806
----------------------------------------------------------------
2. compile and install
----------------------------------------------------------------
[root@gphd-vm33 mpiblast-1.6.0]# pwd
/nfs_share/bio/mpiblast-1.6.0
[root@gphd-vm33 mpiblast-1.6.0]# ./configure --prefix=/nfs_share/bio/mpiblast_install --with-mpi=/usr
2.1) compile ncbi
[root@gphd-vm33 mpiblast-1.6.0]# make ncbi
the executable binaries are loated in: ./ncbi/build/ and ./ncbi/bin
2.2) compile mpiBLAST
[root@gphd-vm33 bio]# make
2.3) install mpiBLAST
[root@gphd-vm33 mpiblast-1.6.0]# make install
[root@gphd-vm33 bio]# ll mpiblast_install/bin/
total 28040
-rwxr-xr-x 1 root root 13045015 Feb 15 05:29 mpiblast
-rwxr-xr-x 1 root root  7589004 Feb 15 05:29 mpiblast_cleanup
-rwxr-xr-x 1 root root  8030151 Feb 15 05:29 mpiformatdb
mpiblast has been installed under mpiblast_install
----------------------------------------------------------------
3. config
----------------------------------------------------------------
[root@gphd-vm33 blastdb]# vi ~/.ncbirc 
[NCBI]
Data=/nfs_share/bio/mpiblast-1.6.0/ncbi/data

[BLAST]
BLASTDB=/nfs_share/bio/blast_fragments
BLASTMAT=/nfs_share/bio/mpiblast-1.6.0/ncbi/data

[mpiBLAST]
Shared=/nfs_share/bio/mpiblast_shared
Local=/tmp/mpiblast_local_dir
[root@gphd-vm33 bio]# mkdir mpiblast_shared
----------------------------------------------------------------
3. prepare data
----------------------------------------------------------------
[root@gphd-vm33 blastdb]# pwd
/nfs_share/bio/blastdb
[root@gphd-vm33 blastdb]# wget ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/drosoph.nt.gz
[root@gphd-vm33 blastdb]# gunzip drosoph.nt.gz
[root@gphd-vm33 blastdb]# mpiformatdb -N 4 -i drosoph.nt -o T -p F -n /nfs_share/bio/blastdb

[root@gphd-vm33 blastdb]# /nfs_share/bio/mpiblast_install/bin/mpiformatdb -i ./drosoph.nt --nfrags=4 -pF
----------
-i specifies the input file
--nfrags=4 tells it how many fragments to make, (possibly should be the number of processors you intend to use.)
-p specifies whether it's a protein file or not. put F for false since this is a nucleotide file not an amino acid file.
----------------------------------------------------------------
4. run
----------------------------------------------------------------

[root@gphd-vm33 bio]# mpirun --hostfile /root/orte_hosts -np 4 mpiblast -d drosoph.nt -i blast.in -p blastn -o results.txt




3) compile ncbi




[root@gphd-vm33 bio]# wget http://www.mpiblast.org/downloads/files/mpiBLAST-1.6.0-patch-110806
[root@gphd-vm33 bio]# wget http://www.mpiblast.org/downloads/files/mpiBLAST-1.6.0-patch-100813
-------------------
Fixed the compiling issue with GCC 4.2 and newer versions.
[root@gphd-vm33 mpiblast-1.6.0]# patch -p1 < ../mpiBLAST-1.6.0-patch-110806
-------------------
mpiBLAST-1.6.0-patch-100813
Fixed the compiling issue of NCBI toolkit on Mac OS X.
Fixed linking issues with OpenMPI (e.g., MPI::Datatype::free() undefined.)
----------------------------------------------------------------
2. compile and install
----------------------------------------------------------------
[root@gphd-vm33 mpiblast-1.6.0]# ./configure --prefix=/nfs_share/bio/mpiblast_install  --with-mpi=/usr
--with-ncbi=/nfs_share/bio/mpiblast_install/ncbi
3d) Build NCBI BLAST
make ncbi
*The new binaries are located in ./ncbi/build/ directory*
3e) Build mpiBLAST
make
3f) Install mpiBLAST
make install
----------------------------------------------------------------
4. prepare the database
----------------------------------------------------------------
1) download mito.nt.gz from ftp://ftp.ncbi.nlm.nih.gov/blast/db/FASTA/
2) 
----------------------------------------------------------------
5. config
----------------------------------------------------------------
1)Configure mpiBLAST by editing the ~/.ncbirc file

[NCBI]
Data=/nfs_share/bio/mpiblast-1.6.0/ncbi/data

[BLAST]
BLASTDB=/nfs_share/bio/shared_storage_dir
BLASTMAT=/nfs_share/bio/mpiblast-1.6.0/ncbi/data

[mpiBLAST]
Shared=/nfs_share/bio/shared_storage_dir
Local=/tmp/mpiblast_local_dir

----------------------------------------------------------------


----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
1.2) download ncbi, untar, move to mpiblast-1.6.0
[root@gphd-vm33 bio]# wget ftp://ftp.ncbi.nih.gov/toolbox/ncbi_tools/ncbi.tar.gz
[root@gphd-vm33 bio]# tar -zxvf ncbi.tar.gz
[root@gphd-vm33 bio]# rm -rf mpiblast-1.6.0/ncbi
[root@gphd-vm33 bio]# mv ncbi mpiblast-1.6.0/
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------